--- a/glib/glib/gthread-posix.c	2014-01-16 16:09:41.000000000 +0800
+++ b/glib/glib/gthread-posix.c	2014-01-16 16:10:00.000000000 +0800
@@ -1172,8 +1172,10 @@
 g_system_thread_set_name (const gchar *name)
 {
 #ifdef HAVE_SYS_PRCTL_H
+#ifdef PR_SET_NAME
   prctl (PR_SET_NAME, name, 0, 0, 0, 0);
 #endif
+#endif
 }
 
 /* {{{1 Epilogue */
